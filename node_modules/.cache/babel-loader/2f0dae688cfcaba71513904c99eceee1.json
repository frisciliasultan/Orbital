{"ast":null,"code":"var _jsxFileName = \"/Users/frisciliasultan/Documents/Orbitalhosting/src/Pages/Module Planner Page/ModulePlannerPage.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport Board from './Board';\nimport Rules from './Rules';\nimport TrashBox from './TrashBox';\nimport './plannertemp.css';\nimport { Button, Card } from 'react-bootstrap';\nimport { Alert, Spin, message } from \"antd\";\nimport { HTML5Backend as Backend } from 'react-dnd-html5-backend';\nimport { DndProvider } from 'react-dnd';\nimport { connect } from 'react-redux';\nimport { callBackendAPI, setCallBackendNow, setSelectedModules, evalRules, setRules } from '../../actions/modplanActions';\nimport { updateSettings, setFirstRender } from \"../../actions/settingsActions\";\nimport { removeSuccess } from \"../../actions/successActions\";\nimport { handleSaveClick, generateObject } from \"../../utils/commonFunctions\";\nimport PropTypes from 'prop-types';\nimport isEmpty from 'is-empty';\nimport LoadingDots from '../Loading Page/LoadingDots';\nimport { LoadingOutlined } from '@ant-design/icons';\n\nconst ModulePlannerPageTemp = props => {\n  const module = props.modplan.modules;\n  const [ruleFunction, setRuleFunction] = useState();\n  const [alert, setAlert] = useState(false);\n  const antIcon = /*#__PURE__*/React.createElement(LoadingOutlined, {\n    style: {\n      fontSize: 24\n    },\n    spin: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 21\n    }\n  });\n  useEffect(() => {\n    const fetchRules = async () => {\n      const evalfunc = await props.callBackendAPI(\"Rules\", props.settings.userInfo.modPlan, props.history);\n      setRuleFunction(evalfunc);\n    };\n\n    if (!isEmpty(props.settings.userInfo)) {\n      if (isEmpty(props.modplan.rules)) {\n        fetchRules();\n      }\n\n      if (!isEmpty(props.settings.userInfo.modPlan) && isEmpty(props.modplan.selectedModules) && props.settings.firstRender) {\n        props.setSelectedModules(null, props.settings.userInfo.modPlan, props.history);\n        props.setFirstRender(false);\n      }\n    }\n  }, [props.settings.userInfo]);\n  useEffect(() => {\n    if (isEmpty(props.modplan.modules)) {\n      props.callBackendAPI('NUSMods', null, props.history);\n    }\n  }, []);\n\n  const handleEvalButtonClick = () => {\n    const modules = props.modplan.selectedModules;\n\n    if (!isEmpty(modules)) {\n      props.setCallBackendNow(true);\n      const modplan = modules.map(obj => {\n        return obj.moduleCode;\n      });\n\n      const asyncEvalRules = async () => {\n        const newEvaluatedRules = await evalRules(ruleFunction, modplan);\n        console.log(newEvaluatedRules);\n        props.setRules(newEvaluatedRules);\n      };\n\n      asyncEvalRules();\n    } else {\n      message.warning({\n        content: 'Please add modules before evaluating'\n      });\n      message.config({\n        maxCount: 1,\n        duration: .7,\n        top: '70px'\n      });\n    }\n  };\n\n  return isEmpty(props.settings.userInfo) ? /*#__PURE__*/React.createElement(LoadingDots, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 15\n    }\n  }) : /*#__PURE__*/React.createElement(DndProvider, {\n    backend: Backend,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 16\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"page-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    id: \"module-planner-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 21\n    }\n  }, \"Module Planner\")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-module-planner\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"year-display\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 21\n    }\n  }, !isEmpty(props.settings.userInfo.matriculationYear) && generateObject(props.settings.userInfo.matriculationYear, props.settings.userInfo.targetGradYear, \"yearDisplay\", module)), /*#__PURE__*/React.createElement(TrashBox, {\n    module: module,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    className: \"button\",\n    id: \"eval-button\",\n    onClick: () => handleEvalButtonClick(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 21\n    }\n  }, \"Evaluate\"), /*#__PURE__*/React.createElement(Button, {\n    className: \"button\",\n    onClick: () => handleSaveClick(props),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 21\n    }\n  }, \"Save\"), !isEmpty(props.success) && /*#__PURE__*/React.createElement(Alert, {\n    message: props.success,\n    type: \"success\",\n    showIcon: true,\n    closable: true,\n    style: {\n      margin: \"15px 0px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 25\n    }\n  }), !isEmpty(props.success) && setTimeout(props.removeSuccess, 4000) && clearTimeout(setTimeout(props.removeSuccess, 2000)), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 21\n    }\n  }, \"Click on each requirement for further information\"), /*#__PURE__*/React.createElement(Card, {\n    className: \"rule-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Spin, {\n    indicator: antIcon,\n    tip: \"Loading...\",\n    spinning: props.modplan.loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"inner-rule-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Card.Title, {\n    className: \"card-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 29\n    }\n  }, \"Degree Requirements\"), /*#__PURE__*/React.createElement(Card.Body, {\n    className: \"rule-card-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 33\n    }\n  }, /*#__PURE__*/React.createElement(Rules, {\n    rules: props.modplan.rules,\n    settings: props.settings,\n    ruleFunction: ruleFunction,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 37\n    }\n  })))))));\n};\n\nModulePlannerPageTemp.propTypes = {\n  callBackendAPI: PropTypes.func.isRequired,\n  setCallBackendNow: PropTypes.func.isRequired,\n  updateSettings: PropTypes.func.isRequired,\n  setFirstRender: PropTypes.func.isRequired,\n  setSelectedModules: PropTypes.func.isRequired,\n  removeSuccess: PropTypes.func.isRequired,\n  setRules: PropTypes.func.isRequired,\n  modplan: PropTypes.object.isRequired,\n  settings: PropTypes.object.isRequired,\n  cap: PropTypes.object.isRequired,\n  success: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => ({\n  settings: state.settings,\n  cap: state.cap,\n  modplan: state.modplan,\n  success: state.success\n});\n\nexport default connect(mapStateToProps, {\n  callBackendAPI,\n  setCallBackendNow,\n  updateSettings,\n  setFirstRender,\n  setSelectedModules,\n  removeSuccess,\n  setRules\n})(ModulePlannerPageTemp);","map":{"version":3,"sources":["/Users/frisciliasultan/Documents/Orbitalhosting/src/Pages/Module Planner Page/ModulePlannerPage.jsx"],"names":["React","useEffect","useState","Board","Rules","TrashBox","Button","Card","Alert","Spin","message","HTML5Backend","Backend","DndProvider","connect","callBackendAPI","setCallBackendNow","setSelectedModules","evalRules","setRules","updateSettings","setFirstRender","removeSuccess","handleSaveClick","generateObject","PropTypes","isEmpty","LoadingDots","LoadingOutlined","ModulePlannerPageTemp","props","module","modplan","modules","ruleFunction","setRuleFunction","alert","setAlert","antIcon","fontSize","fetchRules","evalfunc","settings","userInfo","modPlan","history","rules","selectedModules","firstRender","handleEvalButtonClick","map","obj","moduleCode","asyncEvalRules","newEvaluatedRules","console","log","warning","content","config","maxCount","duration","top","matriculationYear","targetGradYear","success","margin","setTimeout","clearTimeout","loading","propTypes","func","isRequired","object","cap","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Board from './Board';\nimport Rules from './Rules';\nimport TrashBox from './TrashBox';\nimport './plannertemp.css';\nimport { Button, Card } from 'react-bootstrap';\nimport { Alert, Spin, message } from \"antd\";\nimport { HTML5Backend as Backend } from 'react-dnd-html5-backend';\nimport { DndProvider } from 'react-dnd';\nimport { connect } from 'react-redux';\nimport { callBackendAPI, setCallBackendNow, setSelectedModules, evalRules, setRules } from '../../actions/modplanActions';\nimport { updateSettings, setFirstRender } from \"../../actions/settingsActions\";\nimport { removeSuccess } from \"../../actions/successActions\";\nimport { handleSaveClick, generateObject } from \"../../utils/commonFunctions\";\nimport PropTypes from 'prop-types';\nimport isEmpty from 'is-empty'\nimport LoadingDots from '../Loading Page/LoadingDots';\nimport { LoadingOutlined } from '@ant-design/icons';\n\n\n\nconst ModulePlannerPageTemp = (props) => {\n    const module = props.modplan.modules;\n    const [ruleFunction, setRuleFunction] = useState();\n    const [alert, setAlert] = useState(false);\n    const antIcon = <LoadingOutlined style={{ fontSize: 24 }} spin />;\n\n    useEffect(() => {\n        const fetchRules = async () => {\n            const evalfunc = await props.callBackendAPI(\"Rules\", props.settings.userInfo.modPlan, props.history);\n            setRuleFunction(evalfunc);\n        } \n        if(!isEmpty(props.settings.userInfo)) {\n            if(isEmpty(props.modplan.rules)) {\n                fetchRules();\n            }\n\n            if(!isEmpty(props.settings.userInfo.modPlan) && isEmpty(props.modplan.selectedModules)\n                && props.settings.firstRender) {   \n                props.setSelectedModules(null, props.settings.userInfo.modPlan, props.history);\n                props.setFirstRender(false);\n            }\n        }\n    }, [props.settings.userInfo])\n\n    useEffect(() => {\n        if(isEmpty(props.modplan.modules)){\n            props.callBackendAPI('NUSMods', null, props.history);\n        } \n    }, [])\n\n    const handleEvalButtonClick = () => {\n        const modules = props.modplan.selectedModules;\n        if(!isEmpty(modules)) {\n            props.setCallBackendNow(true);\n            const modplan = modules.map((obj) => {\n                return obj.moduleCode\n            });\n            const asyncEvalRules = async () => {\n                const newEvaluatedRules = await evalRules(ruleFunction, modplan);\n                console.log(newEvaluatedRules)\n                props.setRules(newEvaluatedRules);\n            }\n            asyncEvalRules();\n        } else {\n            message.warning({\n                content: 'Please add modules before evaluating',\n              })\n      \n              message.config({\n                maxCount: 1,\n                duration: .7,\n                top: '70px',\n              })\n        }\n    }\n\n    return (\n        isEmpty(props.settings.userInfo) \n            ? <LoadingDots/>\n            : (<DndProvider backend={Backend} >\n                <div className=\"page-title\">\n                    <h3 id=\"module-planner-title\">Module Planner</h3>\n                </div>\n                \n                <div className=\"container-module-planner\">\n                    <div className=\"year-display\">\n                    {!isEmpty(props.settings.userInfo.matriculationYear) \n                        && generateObject(props.settings.userInfo.matriculationYear, \n                                props.settings.userInfo.targetGradYear, \n                                \"yearDisplay\",\n                                module\n                                )}\n                    </div>\n                    \n                    <TrashBox\n                            module={module}/>\n    \n    \n                    <br/>\n    \n                    <Button className=\"button\" id=\"eval-button\" onClick={() => handleEvalButtonClick()}>Evaluate</Button>\n\n                    <Button className=\"button\" onClick={() => handleSaveClick(props)} >Save</Button>\n                    \n                    {!isEmpty(props.success) && \n                        <Alert \n                            message={props.success} \n                            type=\"success\" \n                            showIcon \n                            closable\n                            style={{margin: \"15px 0px\"}} />\n                    }\n                    \n                    {!isEmpty(props.success) && \n                        setTimeout(props.removeSuccess, 4000) &&\n                        clearTimeout(setTimeout(props.removeSuccess, 2000))}\n\n                    <p>Click on each requirement for further information</p>\n                    <Card className=\"rule-container\">\n                        <Spin indicator={antIcon} tip=\"Loading...\" spinning={props.modplan.loading}>\n                            <div className=\"inner-rule-container\">\n                            <Card.Title className=\"card-title\">Degree Requirements</Card.Title>\n                                <Card.Body className=\"rule-card-body\">\n                                    <Rules\n                                        rules={props.modplan.rules}\n                                        settings={props.settings}\n                                        ruleFunction={ruleFunction}/>      \n                                </Card.Body>\n                            </div>\n                        </Spin>\n                    </Card>\n                </div>\n            </DndProvider>)\n    )\n}\n\nModulePlannerPageTemp.propTypes = {\n    callBackendAPI: PropTypes.func.isRequired,\n    setCallBackendNow: PropTypes.func.isRequired,\n    updateSettings: PropTypes.func.isRequired,\n    setFirstRender: PropTypes.func.isRequired,\n    setSelectedModules: PropTypes.func.isRequired,\n    removeSuccess: PropTypes.func.isRequired,\n    setRules: PropTypes.func.isRequired,\n    modplan: PropTypes.object.isRequired,\n    settings: PropTypes.object.isRequired,\n    cap: PropTypes.object.isRequired,\n    success: PropTypes.object.isRequired,\n}\n\nconst mapStateToProps = state => ({\n    settings: state.settings,\n    cap: state.cap,\n    modplan: state.modplan,\n    success: state.success,\n});\n\nexport default connect(mapStateToProps, \n                    { callBackendAPI, setCallBackendNow, updateSettings, setFirstRender,\n                        setSelectedModules, removeSuccess, setRules  }) \n                    (ModulePlannerPageTemp);\n"]},"metadata":{},"sourceType":"module"}